tinymce.PluginManager.add("selfsms", function (t, e) {
    function a() {
        var t;
        return t = '<div class="mce-container mce-panel mce-floatpanel mce-menu mce-menu-align">', tinymce.each(options, function (option) {
            t += '<span><a role="option"  class="mce-menu-item mce-menu-item-normal mce-first mce-last mce-stack-layout-item" data-bulle-type="'+option[1]+'">'+option[0]+'</a></span>'
        }), t += "</div>"
    }
    var options = [
        ["bulle à gauche", "bulle left"],
        ["bulle à droite", "bulle right"]
    ];

    t.addButton("selfsms", {
        type: "panelbutton",
        panel: {
            role: "application",
            autohide: !0,
            html: a,
            onclick: function (e) {
            	tinyMCE.activeEditor.focus();
            	var editorContent = tinyMCE.activeEditor.getContent();
                var a = t.dom.getParent(e.target, "a");
                var type = a.getAttribute("data-bulle-type");

                if(editorContent.indexOf("header-sms") == -1){
                    var operator = prompt("Merci de spécifier l'opérateur téléphonique");
                    var hour = prompt("L'heure affichée sur le téléphone");
                    var batterie = prompt("Le pourcentage de batterie restant");
                    var contact = prompt("et enfin le nom du contact.");
                	t.insertContent("<div class='row phone-header'><div class='col-md-4 phone-operator'><span class='glyphicon glyphicon-signal'>&nbsp;</span>"+ operator+"</div><div class='phone-hour col-md-4 '>"+ hour +"</div><div class='phone-batterie col-md-4'><span class='glyphicon glyphicon-volume-up'>&nbsp;</span>"+ batterie +"</div></div><div class='row header-sms'><div class='col-md-12'>"+ contact +"</div> </div>&nbsp;");
                }
                var content = prompt("Contenu de la bulle");
                t.insertContent("<div><div class='"+type+"'>"+content+"</div>&nbsp;</div>"), this.hide();
            }
        },
        text: 'SMS',
	    icon: false
    })
});