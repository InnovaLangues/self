<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Export PDF : du {{ "now"|date("d/m/Y") }} </title>
<!-- Pour ajouter une pagination/saut de page -->
<!-- 1/2 : ajouter ce style CSS -->
    <style type="text/css">
    .page-breaker {
        display: block;
        page-break-after: always;
        clear:both;
    }
    }
    </style>
</head>
<body>
<b>Test</b> : {{ test.name }}<br />
<b>Langue</b> : {{ test.language.name }}<br />
<b>Date de l'export</b> : {{ "now"|date("d/m/Y") }}<br />
<p></p>
<p></p>
{% for orderQuestionnaireTest in test.orderQuestionnaireTests %}
    <table>
        <tr>
            <td><b>Thème</b> : {{ orderQuestionnaireTest.questionnaire.theme }}</td>
        </tr>
        <tr>
            <td><b>Niveau</b> : {{ orderQuestionnaireTest.questionnaire.id }} {{ orderQuestionnaireTest.questionnaire.level.name }}</td>
        </tr>
        {% if orderQuestionnaireTest.questionnaire.mediaContext is not null %}
            <tr>
                <td>
                <b>Contexte</b> : {{ orderQuestionnaireTest.questionnaire.mediaContext.id }}
                {% if orderQuestionnaireTest.questionnaire.mediaContext.mediaType.name == "texte" %}
                        {{ orderQuestionnaireTest.questionnaire.mediaContext.description|raw }}
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaContext.mediaType.name == "image" %}
                        <img src="http://self.innovalangues.net/upload/media/{{ orderQuestionnaireTest.questionnaire.mediaContext.url|raw }}">
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaContext.mediaType.name == "audio" %}
                        un son
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaContext.mediaType.name == "video" %}
                        une vidéo
                {% endif %}
                </td>
            </tr>
        {% endif %}

        {% if orderQuestionnaireTest.questionnaire.mediaText is not null %}
            <tr>
                <td><b>Objet de la question</b> :
                {% if orderQuestionnaireTest.questionnaire.mediaText.mediaType.name == "texte" %}
                        {{ orderQuestionnaireTest.questionnaire.mediaText.description|raw }}
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaText.mediaType.name == "image" %}
                        <img src="http://self.innovalangues.net/upload/media/{{ orderQuestionnaireTest.questionnaire.mediaText.url|raw }}">
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaText.mediaType.name == "audio" %}
                        un son
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaText.mediaType.name == "video" %}
                        une vidéo
                {% endif %}
                </td>
            </tr>
        {% endif %}

        {% if orderQuestionnaireTest.questionnaire.mediaBlankText is not null %}
            <tr>
                <td><b>Question</b> :
                {% if orderQuestionnaireTest.questionnaire.mediaBlankText.mediaType.name == "texte" %}
                        {{ orderQuestionnaireTest.questionnaire.mediaBlankText.description|raw }}
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaBlankText.mediaType.name == "image" %}
                        <img src="http://self.innovalangues.net/upload/media/{{ orderQuestionnaireTest.questionnaire.mediaBlankText.url|raw }}">
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaBlankText.mediaType.name == "audio" %}
                        un son
                {% endif %}
                {% if orderQuestionnaireTest.questionnaire.mediaBlankText.mediaType.name == "video" %}
                        une vidéo
                {% endif %}
                </td>
            </tr>
        {% endif %}

        {% for question in orderQuestionnaireTest.questionnaire.questions %}
        {# Vérifié en prod : instruction_id et media_id sont toujours "null", donc pas de tests sur ces colonnes. #}
                <tr>
                    <td><b>Typologie</b> : {{ question.typology.name }}</td>
                </tr>
                {% for subquestion in question.subquestions %}
                    <tr>
{#
                        <td>
                            if proposition.media.mediaPurpose.name == "proposition"
                            subQuestion :{{ subquestion.id }}
                        </td>
#}
                        {% if subquestion.mediaAmorce is not null %}
                            <td>
                                <b>Amorce</b> :{{ subquestion.mediaAmorce.name|raw }}
                            </td>
                        {% endif %}
                        {% if subquestion.mediaSyllable is not null %}
                            <td>
                                <b>Syllabe</b> :{{ subquestion.mediaSyllable.name|raw }}
                            </td>
                        {% endif %}
                    </tr>
                    <tr>
                        <td>
                            <b>Propositions</b> :
                            {% for proposition in subquestion.propositions %}

{#
                                ///
                                {{ dump(proposition.media.mediaPurpose.id ) }}
                                ***
                                {{ dump(proposition.media.mediaPurpose.name ) }}
                                ---
#}
                                {% if proposition.media.mediaPurpose is not null %}
                                    {% if proposition.rightAnswer and proposition.media.mediaPurpose.name == "proposition" %}
                                        <b>{{ proposition.media.name|raw }}</b> /
                                    {% else %}
                                        {{ proposition.media.name|raw }} /
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                        </td>
                    </tr>
            {% endfor %}
        {% endfor %}
    </table>
    <!-- 2/2 : ajouter cette ligne pour faire un saut de page entre chaque questionnaire -->
    <div class="page-breaker"></div>
{% endfor %}

</body>
</html>